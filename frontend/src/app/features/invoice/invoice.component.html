<div class="page" *ngIf="invoice() as inv; else loadingTpl">
  <nav class="crumbs">
    <a routerLink="/">Home</a>
    <span>/</span>
    <a routerLink="/invoices">Invoices</a>
    <span>/</span>
    <span class="current">{{ inv.id | uppercase }}</span>
  </nav>

  <div class="toolbar no-print">
    <button class="danger" (click)="exportAsPdf()">Export as PDF</button>
  </div>

  <header class="inv-header">
    <div class="party">
      <p class="muted">from</p>
      <h3>{{ inv.from.name }}</h3>
      <p>{{ inv.from.address }}</p>
      <p>{{ inv.from.cityStateZip }}</p>
      <p>Phone: {{ inv.from.phone }}</p>
      <p *ngIf="inv.from.fax">Fax: {{ inv.from.fax }}</p>
    </div>

    <div class="party to">
      <p class="muted">to</p>
      <h3>{{ inv.to.name }}</h3>
      <p *ngIf="inv.to.address">Address: {{ inv.to.address }}</p>
      <p *ngIf="inv.to.email">Email: {{ inv.to.email }}</p>
      <p *ngIf="inv.to.phone">Phone: {{ inv.to.phone }}</p>
      <span class="pill" [class.paid]="inv.to.status === 'PAID'">{{ inv.to.status }}</span>
    </div>

    <div class="meta">
      <p class="muted">Invoice Number:</p>
      <p class="inv-id">#{{ inv.id | uppercase }}</p>
      <p><strong>Invoice Date:</strong> {{ inv.invoiceDate | date:'MMM d, y' }}</p>
      <p class="muted">Due Date: {{ inv.dueNote }}</p>
    </div>
  </header>

  <section class="items">
    <div class="thead">
      <div>#</div>
      <div>Provided Services</div>
      <div class="right">RATE</div>
      <div class="right">TOTAL</div>
    </div>

    <div class="row" *ngFor="let it of inv.items; index as i">
      <div>{{ i + 1 }}</div>
      <div>{{ it.description }}</div>
      <div class="right">{{ it.rate | currency:'USD':'symbol' }}</div>
      <div class="right">{{ it.total | currency:'USD':'symbol' }}</div>
    </div>

    <div class="summary">
      <div class="left">
        <div class="cell">
          <span class="muted">SUBTOTAL</span>
          <strong>{{ subtotal() | currency:'USD':'symbol' }}</strong>
        </div>
        <div class="cell">
          <span class="muted">TAX ({{ inv.taxRatePct }}%)</span>
          <strong>{{ tax() | currency:'USD':'symbol' }}</strong>
        </div>
      </div>
      <div class="grand">
        <span class="muted">TOTAL</span>
        <strong>{{ grandTotal() | currency:'USD':'symbol' }}</strong>
      </div>
    </div>
  </section>

  <footer class="thanks">
    <p>THANK YOU FOR YOUR BUSINESS</p>
    <p>securecapita.com</p>
    <p>Telephone: (123) 456-7890</p>
    <p>Email: billing@securecapita.com</p>
  </footer>
</div>

<ng-template #loadingTpl>
  <div class="loading">Loading invoiceâ€¦</div>
</ng-template>
